jQuery(document).ready(function(n){function s(i){i.each(function(){var e=n(this),i={},u;i.timelineWrapper=e.find(".events-wrapper");i.eventsWrapper=i.timelineWrapper.children(".events");i.fillingLine=i.eventsWrapper.children(".filling-line");i.timelineEvents=i.eventsWrapper.find("a");i.timelineDates=d(i.timelineEvents);i.eventsMinLapse=g(i.timelineDates);i.timelineNavigation=e.find(".cd-timeline-navigation");i.eventsContent=e.children(".events-content");b(i,t);u=k(i,t);e.addClass("loaded");i.timelineNavigation.on("click",".next",function(n){n.preventDefault();h(i,u,"next")});i.timelineNavigation.on("click",".prev",function(n){n.preventDefault();h(i,u,"prev")});i.eventsWrapper.on("click","a",function(t){t.preventDefault();i.timelineEvents.removeClass("selected");n(this).addClass("selected");a(n(this));f(n(this),i.fillingLine,u);l(n(this),i.eventsContent)});i.eventsContent.on("swipeleft",function(){var n=w();n=="mobile"&&r(i,u,"next")});i.eventsContent.on("swiperight",function(){var n=w();n=="mobile"&&r(i,u,"prev")});n(document).keyup(function(n){n.which=="37"&&p(e.get(0))?r(i,u,"prev"):n.which=="39"&&p(e.get(0))&&r(i,u,"next")})})}function h(n,i,r){var e=v(n.eventsWrapper),f=Number(n.timelineWrapper.css("width").replace("px",""));r=="next"?u(n,e-f+t,f-i):u(n,e+f-t)}function r(n,t,i){var e=n.eventsContent.find(".selected"),o=i=="next"?e.next():e.prev(),u,r;o.length>0&&(u=n.eventsWrapper.find(".selected"),r=i=="next"?u.parent("li").next("li").children("a"):u.parent("li").prev("li").children("a"),f(r,n.fillingLine,t),l(r,n.eventsContent),r.addClass("selected"),u.removeClass("selected"),a(r),c(i,r,n))}function c(n,t,i){var o=window.getComputedStyle(t.get(0),null),r=Number(o.getPropertyValue("left").replace("px","")),f=Number(i.timelineWrapper.css("width").replace("px","")),s=Number(i.eventsWrapper.css("width").replace("px","")),e=v(i.eventsWrapper);(n=="next"&&r>f-e||n=="prev"&&r<-e)&&u(i,-r+f/2,f-s)}function u(n,t,i){var r=n.eventsWrapper.get(0);t=t>0?0:t;t=!(typeof i=="undefined")&&t<i?i:t;y(r,"translateX",t+"px");t==0?n.timelineNavigation.find(".prev").addClass("inactive"):n.timelineNavigation.find(".prev").removeClass("inactive");t==i?n.timelineNavigation.find(".next").addClass("inactive"):n.timelineNavigation.find(".next").removeClass("inactive")}function f(n,t,i){var u=window.getComputedStyle(n.get(0),null),r=u.getPropertyValue("left"),e=u.getPropertyValue("width"),f;r=Number(r.replace("px",""))+Number(e.replace("px",""))/2;f=r/i;y(t.get(0),"scaleX",f)}function b(n,t){for(i=0;i<n.timelineDates.length;i++){var r=e(n.timelineDates[0],n.timelineDates[i]),u=Math.round(r/n.eventsMinLapse)+2;n.timelineEvents.eq(i).css("left",u*t+"px")}}function k(n,t){var u=e(n.timelineDates[0],n.timelineDates[n.timelineDates.length-1]),r=u/n.eventsMinLapse,r=Math.round(r)+4,i=r*t;return n.eventsWrapper.css("width",i+"px"),f(n.eventsWrapper.find("a.selected"),n.fillingLine,i),c("next",n.eventsWrapper.find("a.selected"),n),i}function l(n,t){var e=n.data("date"),r=t.find(".selected"),i=t.find('[data-date="'+e+'"]'),o=i.height(),u,f;i.index()>r.index()?(u="selected enter-right",f="leave-left"):(u="selected enter-left",f="leave-right");i.attr("class",u);r.attr("class",f).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){r.removeClass("leave-right leave-left");i.removeClass("enter-left enter-right")});t.css("height",o+"px")}function a(n){n.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function v(n){var i=window.getComputedStyle(n.get(0),null),t=i.getPropertyValue("-webkit-transform")||i.getPropertyValue("-moz-transform")||i.getPropertyValue("-ms-transform")||i.getPropertyValue("-o-transform")||i.getPropertyValue("transform"),r;return t.indexOf("(")>=0?(t=t.split("(")[1],t=t.split(")")[0],t=t.split(","),r=t[4]):r=0,Number(r)}function y(n,t,i){n.style["-webkit-transform"]=t+"("+i+")";n.style["-moz-transform"]=t+"("+i+")";n.style["-ms-transform"]=t+"("+i+")";n.style["-o-transform"]=t+"("+i+")";n.style.transform=t+"("+i+")"}function d(t){var i=[];return t.each(function(){var e=n(this),t=e.data("date").split("T"),r,u,f;t.length>1?(r=t[0].split("/"),u=t[1].split(":")):t[0].indexOf(":")>=0?(r=["2000","0","0"],u=t[0].split(":")):(r=t[0].split("/"),u=["0","0"]);f=new Date(r[2],r[1]-1,r[0],u[0],u[1]);i.push(f)}),i}function e(n,t){return Math.round(t-n)}function g(n){var t=[],r;for(i=1;i<n.length;i++)r=e(n[i-1],n[i]),t.push(r);return Math.min.apply(null,t)}function p(n){for(var t=n.offsetTop,i=n.offsetLeft,r=n.offsetWidth,u=n.offsetHeight;n.offsetParent;)n=n.offsetParent,t+=n.offsetTop,i+=n.offsetLeft;return t<window.pageYOffset+window.innerHeight&&i<window.pageXOffset+window.innerWidth&&t+u>window.pageYOffset&&i+r>window.pageXOffset}function w(){return window.getComputedStyle(document.querySelector(".cd-horizontal-timeline"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}var o=n(".cd-horizontal-timeline"),t=60;o.length>0&&s(o);n.fn.horizontalTimeline=function(){return this.each(function(){s(n(this))})}}),function(n){n.validator.setDefaults({errorElement:"span",errorClass:"help-block help-block-validation-error",focusInvalid:!1,submitOnKeyPress:!0,highlight:function(t){n(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){n(t).closest(".form-group").removeClass("has-error")},errorPlacement:function(n,t){t.closest(".input-icon").size()===1?n.insertAfter(t.closest(".input-icon")):n.insertAfter(t)},success:function(n){n.closest(".form-group").removeClass("has-error");n.remove()},submitHandler:function(t){n(t).find(".alert-danger").hide()}})}(jQuery),function(){app.modals.LookupModal=function(){function f(){r.ajax.reload()}function e(i){var r=t.canSelect(i);if(r){if(r===!0){n.setResult(i);n.close();return}r.then(function(t){t&&(n.setResult(i),n.close())})}}var n,r,u,i,t={serviceMethod:null,title:app.localize("SelectAnItem"),loadOnStartup:!0,showFilter:!0,filterText:"",pageSize:app.consts.grid.defaultPageSize,canSelect:function(){return!0}};this.init=function(o){n=o;t=$.extend(t,n.getOptions().lookupOptions);u=n.getModal().find(".lookup-modal-table");r=u.DataTable({paging:!0,serverSide:!0,processing:!0,lengthChange:!1,pageLength:t.pageSize,deferLoading:t.loadOnStartup?null:0,listAction:{ajaxFunction:t.serviceMethod,inputFilter:function(){return $.extend({filter:i.val()},n.getArgs().extraFilters)}},columnDefs:[{targets:0,data:null,orderable:!1,defaultContent:"",rowAction:{element:$("<button/>").addClass("btn btn-default btn-xs").attr("title",app.localize("Select")).append($("<i/>").addClass("fa fa-chevron-circle-right")).click(function(){var n=$(this).data();e(n)})}},{targets:1,data:"name"}]});n.getModal().find(".lookup-filter-button").click(function(n){n.preventDefault();f()});n.getModal().find(".modal-body").keydown(function(n){n.which===13&&(n.preventDefault(),f())});i=n.getModal().find(".lookup-filter-text");i.val(t.filterText)}};app.modals.LookupModal.create=function(n){return new app.ModalManager({viewUrl:abp.appPath+"AppAreaName/Common/LookupModal",scriptUrl:abp.appPath+"view-resources/Areas/AppAreaName/Views/Common/Modals/_LookupModal.js",modalClass:"LookupModal",lookupOptions:n})}}();