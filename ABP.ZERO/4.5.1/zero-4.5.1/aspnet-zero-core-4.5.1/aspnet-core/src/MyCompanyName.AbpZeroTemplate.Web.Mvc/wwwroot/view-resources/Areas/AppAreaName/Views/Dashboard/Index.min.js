(function(){$(function(){var n=abp.services.app.tenantDashboard,t=d3.scale.category10(),i={daily:1,weekly:2,monthly:3},r=function(n,t,i,r){$("#totalProfit").text(n);$("#newFeedbacks").text(t);$("#newOrders").text(i);$("#newUsers").text(r)},u=function(t,i,r,u,f){var o=function(t){var i=function(n){return new Morris.Area({element:t,padding:0,behaveLikeLine:!1,gridEnabled:!1,gridLineColor:!1,axes:!1,fillOpacity:1,data:n,lineColors:["#399a8c","#92e9dc"],xkey:"period",ykeys:["sales","profit"],labels:["Sales","Profit"],pointSize:0,lineWidth:0,hideHover:"auto",resize:!0})},r=function(t){var i=this;n.getSalesSummary({salesSummaryDatePeriod:t}).done(function(n){i.graph.setData(n.salesSummary);i.graph.redraw()})},u=function(n){this.graph?(this.graph.setData(n),this.graph.redraw()):this.graph=i(n)};return{draw:u,refresh:r,graph:null}},e;$("#salesStatistics").show();e=new o("salesStatistics");e.draw(t);$("input[name='SalesSummaryDateInterval'").change(function(){e.refresh(this.value)});$("#totalSales").text(i);$("#revenue").text(r);$("#expenses").text(u);$("#growth").text(f);$("#salesStatisticsLoading").hide()},f=function(t,i,r){var u=function(n,t,i){$("#transactionPercent").attr("data-percent",n);$("#transactionPercent span").text(n);$("#newVisitPercent").attr("data-percent",t);$("#newVisitPercent span").text(t);$("#bouncePercent").attr("data-percent",i);$("#bouncePercent span").text(i);$(".easy-pie-chart-loading").hide()},f=function(n,t,i){$("#transactionPercent").data("easyPieChart").update(n);$("#transactionPercent span").text(n);$("#newVisitPercent").data("easyPieChart").update(t);$("#newVisitPercent span").text(t);$("#bouncePercent").data("easyPieChart").update(i);$("#bouncePercent span").text(i)},e=function(){$(".easy-pie-chart .number.transactions").easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:App.getBrandColor("yellow")});$(".easy-pie-chart .number.visits").easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:App.getBrandColor("green")});$(".easy-pie-chart .number.bounce").easyPieChart({animate:1e3,size:75,lineWidth:3,barColor:App.getBrandColor("red")})};$("#generalStatsReload").click(function(){n.getGeneralStats({}).done(function(n){f(n.transactionPercent,n.newVisitPercent,n.bouncePercent)})});u(t,i,r);e()},e=function(t,i,r){var u=function(n,t,i){$("#network").sparkline(i,{type:"bar",width:"100",barWidth:5,height:"55",barColor:"#35aa47",negBarColor:"#e02222"});$("#cpu-load").sparkline(t,{type:"bar",width:"100",barWidth:5,height:"55",barColor:"#ffb848",negBarColor:"#e02222"});$("#load-rate").sparkline(i,{type:"line",width:"100",height:"55",lineColor:"#ffb848"})},f=function(){n.getServerStats({}).done(function(n){u(n.networkLoad,n.cpuLoad,n.loadRate)})};$("#serverStatsReload").click(function(){f()});u(t,i,r);$(".sparkline-chart-loading").hide()},o=function(){var f=function(i){var r=function(n){return new Datamap({element:document.getElementById(i),projection:"mercator",fills:{defaultFill:"#ABDDA4",key:"#fa0fa0"},data:n,done:function(n){function t(){n.svg.selectAll("g").attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")")}n.svg.call(d3.behavior.zoom().on("zoom",t))}})},u=function(){var i=this;n.getWorldMap({}).done(function(n){for(var u,f={},r=0;r<n.countries.length;r++)u=n.countries[r],f[u.countryName]=t(Math.random()*u.color);i.graph.updateChoropleth(f)})},f=function(n){this.graph?this.redraw():this.graph=r(n)};return{draw:f,redraw:u,graph:null}},i="worldmap",r=function(){var n=new f(i);return n.draw({USA:{fillKey:"key"},JPN:{fillKey:"key"},ITA:{fillKey:"key"},CRI:{fillKey:"key"},KOR:{fillKey:"key"},DEU:{fillKey:"key"},TUR:{fillKey:"key"},RUS:{fillKey:"key"}}),n},u=r();setInterval(function(){u.redraw()},5e3);$(window).resize(function(){$("#"+i).empty();u=r()})},s=function(n){var r=$("#timelineDetails"),u=$("#timelineDateList"),f=$("#horizontalTimelineContainer"),s=$("#horizontalTimelineLoading"),i,t,e,o;for(r.empty(),u.empty(),i=0;i<n.length;i++)t=n[i],e=abp.utils.formatString("<li><a href='#0' data-date='{0}' class='border-after-red bg-after-red {2}'>{1}<\/a><\/li>",t.shortDate,t.titleDate,i===0?"selected":""),u.append(e),o=abp.utils.formatString("<li class='{0}' data-date='{1}'><div class='mt-title'><h2 class='mt-content-title'>{2}<\/h2><\/div><div class='mt-author' > <div class='mt-avatar' > <img src='{3}'/><\/div> <div class='mt-author-name' > <a href= 'javascript:;' class='font-blue-madison'>{4}<\/a > <\/div><div class='mt-author-datetime font-grey-mint'>{5}<\/div><\/div> <div class='clearfix'><\/div > <div class='mt-content border-grey-steel' style='max-height: 70px;overflow: auto;'> <p>{6}<\/p> <\/div > <\/li>",i===0?"selected":"",t.shortDate,t.title,abp.appPath+"metronic/assets/admin/layout4/media/users/"+t.image,t.autherName,t.longDate,t.text),r.append(o);f.addClass("cd-horizontal-timeline mt-timeline-horizontal");n&&$(".cd-horizontal-timeline").horizontalTimeline();s.hide();f.show()},h=function(){var t=function(){n.getMemberActivity({}).done(function(n){$("#memberActivityTable tbody>tr").each(function(t){var i=$(this).find("td"),r=$("<a/>").attr("href","javascript:;").addClass("primary-link").text(n.memberActivities[t].name);$(i[1]).empty().append(r);$(i[2]).html(n.memberActivities[t].cases);$(i[3]).html(n.memberActivities[t].closed);$(i[4]).html(n.memberActivities[t].rate);$(i[5]).html(n.memberActivities[t].rate);$(i[6]).html(n.memberActivities[t].earnings)})})};$("#refreshMemberActivityButton").click(function(){t()});t()},c=function(){n.getDashboardData({salesSummaryDatePeriod:i.daily}).done(function(n){u(n.salesSummary,n.totalSales,n.revenue,n.expenses,n.growth);r(n.totalProfit,n.newFeedbacks,n.newOrders,n.newUsers);e(n.networkLoad,n.cpuLoad,n.loadRate);f(n.transactionPercent,n.newVisitPercent,n.bouncePercent);s(n.timeLineItems);$(".counterup").counterUp()})};o();h();c()})})();